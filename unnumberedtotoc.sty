%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version
% 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
% 
% The Current Maintainer of this work is Johannes Böttcher
%
% This work consists of the file unnumberedtotoc.sty
% Copyright 2014 - 2016 Johannes Böttcher
% This is an alpha Version. Please be aware that there is
% absolutely no warranty and use this package at your own risk

 \ProvidesPackage{unnumberedtotoc}[2016/10/09 v.02 unnumbered chapters and sectionsto toc]
 \RequirePackage{etoolbox}

 \ifundef{\KOMAClassName}{%
  \PackageWarningNoLine{unnumberedtotoc}{%
   ^^J adding some features also provided by the KOMA classes.
   ^^J Consider switching, as there are much more features with KOMA.
   ^^J Found at: https://github.com/johannesbottcher/unnumberedtotoc
  }
  \@ifclassloaded{memoir}{
   \typeout{Sorry, this wasn't tested with `memoir'}
  }{
  }
 }{\PackageInfo{unnumberedtotoc}{You are using a KOMA
 class. Not much to do for me here. Setting the options
and that's it}
}

 \RequirePackage{scrlfile}
 \newbool{@indentunnumbered}
 \newbool{@listoftotoc}
 \newbool{@listoftotocnumbered}
 \DeclareOption{indentunnumbered}{\booltrue{@indentunnumbered}}
 \DeclareOption{listoftotoc}{\booltrue{@listoftotoc}}
 \DeclareOption{listoftotocnumbered}{\booltrue{@listoftotocnumbered}}
 \ProcessOptions*
\RequirePackage{tocbasic}
\RequirePackage{xparse}
\ifbool{@indentunnumbered}{
 \AfterPackage*{tocbasic}{\setuptoc{toc}{numberline}}
 \@ifpackageloaded{tocbibind}{\PackageWarningNoLine{unnumberedtotoc}{
  You loaded package `tocbibind' and requested option
  `indentunnumbered'. I am using a workaround to get this
  done
 }}{
  \PreventPackageFromLoading[
   \PackageWarningNoLine{unnumberedtotoc}{
    `tocbibind' is not compatible with this package.^^J
    Please use the features described in the
    KOMA-documentation
   }
  ]{tocbibind}
 }
}{}

\providecommand{\listoflotname}{List of Tables}%
\providecommand{\listoflofname}{List of Figures}%
\addtotoclist[float]{lof}%
\addtotoclist[float]{lot}%
\addtotoclist{toc}%
\renewcommand{\listoffigures}{\listoftoc{lof}}
\renewcommand{\listoftables}{\listoftoc{lot}}

\ifbool{@listoftotocnumbered}{
 \AfterPackage*{unnumberedtotoc}{
  \doforeachtocfile[float]{\setuptoc{\@currext}{numbered}}
 }
}{}
\ifbool{@listoftotoc}{
 \AfterPackage*{unnumberedtotoc}{
  \doforeachtocfile{\setuptoc{\@currext}{totoc}}
 }
}{}

\ifdef{\KOMAClassName}{\typeout{I set the appropriate options for
KOMA. See ya}\endinput}{}
\renewcommand{\tableofcontents}{\listoftoc{toc}}
\providecommand*\listoftocname{\contentsname}


\ProvideDocumentCommand{\addpart}{ s o m }{%
 \part*{#3}%
 \IfBooleanTF{#1}{
 \markboth{}{}
 }{
  \IfNoValueTF{#2}{
   \addxcontentsline{toc}{part}{#3}
   \markboth{\MakeMarkcase{#3}}{}%
  }{%
   \addxcontentsline{toc}{part}{#2}
   \markboth{\MakeMarkcase{#2}}{}%
  }
 }
}
\ProvideDocumentCommand{\addchap}{ s o m }{%
 \chapter*{#3}%
 \IfBooleanTF{#1}{
 \markboth{}{}
 }{
  \IfNoValueTF{#2}{
   \addxcontentsline{toc}{chapter}{#3}
   \markboth{\MakeMarkcase{#3}}{}%
  }{%
   \addxcontentsline{toc}{chapter}{#2}
   \markboth{\MakeMarkcase{#2}}{}%
  }
 }
}

\ProvideDocumentCommand{\addsec}{ s o m }{%
 \section*{#3}%
 \IfBooleanTF{#1}{
 \markright{}
 }{
  \IfNoValueTF{#2}{
   \addxcontentsline{toc}{section}{#3}
   \markright{\MakeMarkcase{#3}}%
  }{%
   \addxcontentsline{toc}{section}{#2}
   \markright{\MakeMarkcase{#2}}%
  }
 }
}

\endinput
